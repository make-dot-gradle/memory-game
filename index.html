<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <title>Izvēlēties pārus</title>
  <script src="mkfromtmplt.js"></script>
  <script>
    var idx = 0;
    const removeParent = el => {
	    let parent = el.parentElement;
	    parent.parentElement.removeChild(parent);
    };
    const makeRow = (idx, pair) => mkFromTmplt({
	    tag: "div",
	    attrs: {"class": "pair"},
	    children: [
		    {tag: "input", attrs: {"class": "car", value: pair[0]}},
		    {tag: "input", attrs: {"class": "cdr", value: pair[1]}},
		    {tag: "input", attrs: {type: "button", value: "X"}, listeners: {click: ev => removeParent(ev.target)}}
	    ]
    });
    function addField(obj) {
	    document.getElementById("fields").appendChild(makeRow(idx, obj));
	    idx++;
    }
    function startGame() {
	    const pairs = [...document.getElementsByClassName("pair")]
		  .map(el => ["car", "cdr"].map(c => el.getElementsByClassName(c)[0].value));
	    if (!pairs) {
		    alert("No pairs provided!");
		    return;
	    }
	    sessionStorage.setItem("pairs", JSON.stringify(pairs));
	    document.location.href = "game.html";
    }
    window.addEventListener("load", function() {
	    const data = sessionStorage.getItem("pairs");
	    if (data === null) return;
	    JSON.parse(data).forEach(addField);
    });
  </script>
</head>
<body>
  <form id="pairs">
    <input type="button" value="+" onclick="addField(['', '']);">
    <div id="fields">
    </div>
    <input type="button" value="Spēlēt" onclick="startGame();">
  </form>
</body>
